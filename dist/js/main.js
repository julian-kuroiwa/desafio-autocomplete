function autocomplete(e){var o=[];for(var t in medicamentos)if(medicamentos.hasOwnProperty(t)){var a=medicamentos[t];if(e.search("\n")){var c=e.split("\n");e=c[c.length-1]}e===a.nome.toLowerCase().slice(0,e.length)&&o.push(a.nome)}return o}var medicamentos=[{fabricante:"Roche",nome:"Roacutan 20mg, Cápsula (30un)",precoMax:22.1,precoMin:20.99,principioAtivo:"Isotretinoína 20mg",titularidade:"Referência"},{fabricante:"Sundown Vitaminas",nome:"Vitamina C, comprimido (100un)",precoMax:45.15,precoMin:31.99,principioAtivo:"Ácido Ascórbico",titularidade:"Referência"},{fabricante:"Sundown Vitaminas",nome:"Vitamina C, comprimido (180un)",precoMax:10,precoMin:10,principioAtivo:"Ácido Ascórbico",titularidade:"Genérico"},{fabricante:"EMS Sigma Pharma",nome:"Itraspor 100mg, Cápsula (15un)",precoMax:209,precoMin:100,principioAtivo:"Itraconazol 100mg",titularidade:"Genérico"},{fabricante:"EMS Sigma Pharma",nome:"Itraspor 100mg, Cápsula (28un)",precoMax:15,precoMin:9.99,principioAtivo:"Itraconazol 100mg",titularidade:"Referência"},{fabricante:"Abbott",nome:"Cloridrato de sibutramina 15mg, Cápsula (30un)",precoMax:40,precoMin:40,principioAtivo:"Cloridrato de sibutramina 15mg",titularidade:"Genérico"},{fabricante:"Abbott",nome:"Cloridrato de sibutramina 15mg, Cápsula (100un)",precoMax:200,precoMin:100,principioAtivo:"Cloridrato de sibutramina 15mg",titularidade:"Referência"}],medTextarea=document.getElementById("getMed"),autocompleteModal=document.querySelector(".get-med__modal"),autocompleteResults=document.querySelector(".get-med__results"),countProduct=[],autocompleteProduct;document.body.addEventListener("click",function(){autocompleteModal.style.display="none"}),medTextarea.onkeyup=function(e){var o=[];if((o=autocomplete(this.value)).length>0&&""!=o){autocompleteResults.innerHTML="";for(var t=0;t<o.length;t++)for(var a=0;a<medicamentos.length;a++){var c=medicamentos[a],i=c.fabricante,r=c.nome,n=c.precoMin.toFixed(2).replace(".",","),d=c.precoMax.toFixed(2).replace(".",","),l=c.principioAtivo,s=c.titularidade;if(o[t]==r){var p="Genérico"==s?'<div class="package__top package__top--generic"></div><div class="package__middle package__middle--generic"><p class="package__generic">G</p></div><div class="package__bottom package__bottom--generic"></div>':'<div class="package__top"></div><div class="package__middle"></div><div class="package__bottom"> </div>',u=n==d?'<p class="price__equal">R$'+n+"</p>":'<p class="price__min">de R$'+n+'</p><p class="price__max">até R$'+d+"</p>";autocompleteResults.innerHTML+='<div class="get-med__product" data-product="'+r+", "+i+'"><div class="product__box product__box--label"><div class="label__package">'+p+'</div></div><div class="product__box product__box--components"><p class="components__name">'+r+'</p><p class="components__composite">'+l+'</p></div><div class="product__box product__box--brand"><p class="brand__med">'+i+'</p><p class="brand__type">'+s+'</p></div><div class="product__box product__box--price">'+u+'<p class="price__sintese">Síntese</p></div></div>'}}medTextarea.addEventListener("input",getCoord),autocompleteProduct=document.querySelectorAll(".get-med__product"),document.querySelector(".load__on").style.display="block",document.querySelector(".load__done").style.display="none",setTimeout(function(){document.querySelector(".load__on").style.display="none",document.querySelector(".load__done").style.display="block",autocompleteProduct[0].classList.add("active")},3500);for(var m in autocompleteProduct)if(autocompleteProduct.hasOwnProperty(m)){autocompleteProduct[m].children;autocompleteProduct[m].addEventListener("click",clickProduct),autocompleteProduct[m].addEventListener("mouseover",function(){autocompleteProduct[0].classList.remove("active")})}}else autocompleteModal.style.display="none"},medTextarea.onkeypress=function(e){switch(e.which){case 13:document.querySelector(".product__box--icon").classList.add("product__box--search"),autocompleteModal.style.display="none"}};var getCoord=function(e){var o=medTextarea.selectionEnd,t=document.createElement("div"),a=document.createElement("span"),c=getComputedStyle(medTextarea),i={};[].forEach.call(c,function(e){t.style[e]=c[e]}),t.style.position="absolute",document.body.appendChild(t),t.textContent=medTextarea.value.substr(0,o),a.textContent=medTextarea.value.substr(o)||".",t.appendChild(a),i={TOP:a.offsetTop,LEFT:a.offsetLeft},autocompleteModal.style.top=i.TOP+140+"px",document.querySelector(".product__box--icon").style.top=i.TOP+105+"px",autocompleteModal.classList.add("active"),document.body.removeChild(t),60===i.LEFT?autocompleteModal.style.display="none":setTimeout(function(){document.querySelector(".get-med__results").children.length>0&&(autocompleteModal.style.display="block")},1e3)},clickProduct=function(e){var o=this.dataset.product;if(-1==countProduct.indexOf(o)){countProduct.push(o+"\n"),medTextarea.value="";var t=countProduct.join("\n");medTextarea.value+=t}getCoord(),document.querySelector(".product__box--icon").classList.remove("product__box--search"),medTextarea.focus(),autocompleteModal.style.display="none",autocompleteResults.innerHTML=""};